(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{46:function(e,t,r){},48:function(e,t,r){},53:function(e,t,r){"use strict";r.r(t);var n=r(0),c=r.n(n),a=r(18),o=r.n(a),i=(r(46),r(41)),s=r(20),d=r.n(s),l=r(34),j=r(7),b=r(15),u=r(56),O=r(61),h=r(39),p=r(57),x=r(60),f=r(63),v=r(62),m=r(58),g=r(59),C=r(37),y=r(38),k=r.n(y);r(48);var S=r(2),w="https://cscra2.mybluemix.net/api";function I(e){var t=e.url,r=e.height;return Object(n.useEffect)((function(){k.a.embed(t,"#pdfcontainer",{fallbackLink:'<p>Este navegador no soporta la visualizacion de archivos PDF en linea, por favor descarga el archivo haciendo clic : <a href="[url]">aqu\xed</a></p>'})}),[t]),Object(S.jsx)("div",{id:"pdfcontainer",style:{height:r}})}var P=function(){var e=Object(n.useState)({paciente:{id:0,carnet:"",nombre:"",empresa:{nombre:"",estado:""}},doctor:{id:0,nombre:""},proveedor:{id:0,nombre:"",servicios:[]},servicios:[]}),t=Object(b.a)(e,2),r=t[0],c=t[1],a=Object(n.useState)({id:0,nota:""}),o=Object(b.a)(a,2),s=o[0],y=o[1],k=Object(n.useCallback)((function(e){var t=e.target.value.toUpperCase();c(Object(j.a)(Object(j.a)({},r),{},{paciente:Object(j.a)(Object(j.a)({},r.paciente),{},{carnet:t})}))}),[r]),P=Object(n.useCallback)((function(e){c(Object(j.a)(Object(j.a)({},r),{},{doctor:Q.find((function(t){return t.id==parseInt(e.target.value)}))||{id:0,nombre:""}}))}),[r]),T=Object(n.useCallback)((function(e){c(Object(j.a)(Object(j.a)({},r),{},{proveedor:V.find((function(t){return t.id==parseInt(e.target.value)}))||{id:0,nombre:"",servicios:[]}}))}),[r]),L=Object(n.useState)({completed:!1,error:!1}),N=Object(b.a)(L,2),E=N[0],F=N[1],G=Object(n.useRef)(Math.random());console.log(G);var B=function(e,t){var r=Object(n.useRef)(e);return Object(n.useEffect)((function(){r.current=e}),[t]),r}((function(e){c(Object(j.a)(Object(j.a)({},r),{},{paciente:e})),console.log(e)}),[r]),_=Object(n.useCallback)((function(e){(function(){var e=Object(l.a)(d.a.mark((function e(t){var r,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F({completed:!1,error:!1}),e.next=3,fetch(w+"/pacientes?carnet=".concat(t));case 3:if((r=e.sent).ok){e.next=9;break}throw F({completed:!0,error:!0}),new Error("HTTP error! status: ".concat(r.status));case 9:return e.next=11,r.json();case 11:n=e.sent,console.log("GetPaciente",n),F({completed:!0,data:n.length?n[0]:void 0,error:!1}),n.length&&B.current(n[0]);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}})()(r.paciente.carnet).catch((function(e){return console.error(e.message)}))}),[r.paciente.carnet]),D=Object(n.useState)({completed:!1,error:!1}),H=Object(b.a)(D,2),R=H[0],M=H[1],U=Object(n.useCallback)((function(e){e.preventDefault(),function(){var e=Object(l.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return M({completed:!1,error:!1}),e.next=3,fetch(w+"/transferencias",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paciente_id:r.paciente.id,doctor_id:r.doctor.id,proveedor_id:r.proveedor.id,servicios_ids:r.servicios.map((function(e){return e.id}))})});case 3:if((t=e.sent).ok){e.next=9;break}throw M({completed:!0,error:!0}),new Error("HTTP error! status: ".concat(t.status));case 9:return e.next=11,t.json();case 11:n=e.sent,M({completed:!0,data:n,error:!1});case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()().catch((function(e){return console.error(e.message)}))}),[r]),q=Object(n.useState)({completed:!1,error:!1}),J=Object(b.a)(q,2),z=J[0],A=J[1],K=z.data||{doctores:[],proveedores:[],servicios:[]},Q=K.doctores,V=K.proveedores,W=K.servicios,X=Object(n.useState)(V),Y=Object(b.a)(X,2),Z=Y[0],$=Y[1],ee=Object(n.useState)(W),te=Object(b.a)(ee,2),re=te[0],ne=te[1];Object(n.useEffect)((function(){if(z.completed&&!z.error){var e=V.filter((function(e){return r.servicios.every((function(t){return e.servicios.some((function(e){return e.id==t.id}))}))}));console.log("Proveedores",e),$(e),e.some((function(e){return e.id==r.proveedor.id}))||c(Object(j.a)(Object(j.a)({},r),{},{proveedor:{id:0,nombre:"",servicios:[]}})),1==e.length&&c(Object(j.a)(Object(j.a)({},r),{},{proveedor:e[0]}));var t=W.filter((function(t){return e.some((function(e){return!r.servicios.some((function(e){return e.id==t.id}))&&e.servicios.some((function(e){return e.id==t.id}))}))}));console.log("Servicios",t),ne(t)}}),[r.servicios,z]),Object(n.useEffect)((function(){(function(){var e=Object(l.a)(d.a.mark((function e(){var t,r,n,c,a,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([fetch(w+"/doctores"),fetch(w+"/proveedores"),fetch(w+"/servicios")]);case 2:if(!(t=e.sent).some((function(e){return!e.ok}))){e.next=9;break}throw console.log("Init Failed"),A({completed:!0,error:!0}),new Error("HTTP error! status: ");case 9:return e.next=11,Promise.all(t.map((function(e){return e.json()})));case 11:r=e.sent,n=Object(b.a)(r,3),c=n[0],a=n[1],o=n[2],console.log("Init Success",{doctores:c,proveedores:a,servicios:o}),A({completed:!0,data:{doctores:c,proveedores:a,servicios:o},error:!1});case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()().catch((function(e){return console.error(e.message)}))}),[]);var ce=function(){var e=R.data&&R.data.url;return e?Object(S.jsx)(I,{url:e,height:400}):null};return console.log("FormState",r),Object(S.jsxs)(S.Fragment,{children:[Object(S.jsxs)(f.a,{bg:"dark",variant:"dark",children:[Object(S.jsx)(f.a.Brand,{href:"#home",children:"Navbar"}),Object(S.jsxs)(v.a,{className:"mr-auto",children:[Object(S.jsx)(v.a.Link,{href:"#home",children:"Home"}),Object(S.jsx)(v.a.Link,{href:"#features",children:"Features"}),Object(S.jsx)(v.a.Link,{href:"#pricing",children:"Pricing"})]}),Object(S.jsxs)(O.a,{inline:!0,children:[Object(S.jsx)(O.a.Control,{type:"text",placeholder:"Search",className:"mr-sm-2"}),Object(S.jsx)(u.a,{variant:"outline-info",children:"Search"})]})]}),Object(S.jsxs)(m.a,{style:{marginTop:20},children:[Object(S.jsx)("h1",{children:"Transferencia externa"}),z.completed?Object(S.jsxs)(S.Fragment,{children:[Object(S.jsxs)(O.a,{style:{marginTop:20,marginBottom:20},onSubmit:U,children:[Object(S.jsxs)("fieldset",{title:"Paciente",children:[Object(S.jsx)("legend",{children:"Paciente"}),Object(S.jsxs)(O.a.Row,{children:[Object(S.jsxs)(O.a.Group,{as:h.a,sm:!0,controlId:"carnet_paciente",children:[Object(S.jsx)(O.a.Label,{children:"N\xba Carnet"}),Object(S.jsx)(O.a.Control,{type:"text",isInvalid:E.completed&&!E.error&&!E.data,onChange:k,onBlur:_,value:r.paciente.carnet})]}),Object(S.jsxs)(O.a.Group,{as:h.a,sm:9,controlId:"nombre_paciente",children:[Object(S.jsx)(O.a.Label,{children:"Nombre"}),Object(S.jsx)(O.a.Control,{readOnly:!0,type:"text",value:r.paciente.nombre.toUpperCase()})]})]}),Object(S.jsxs)(O.a.Row,{children:[Object(S.jsxs)(O.a.Group,{as:h.a,sm:9,controlId:"empresa",children:[Object(S.jsx)(O.a.Label,{children:"Empresa"}),Object(S.jsx)(O.a.Control,{readOnly:!0,type:"text",value:r.paciente.empresa.nombre.toUpperCase()})]}),Object(S.jsxs)(O.a.Group,{as:h.a,sm:!0,controlId:"estado",children:[Object(S.jsx)(O.a.Label,{children:"Estado"}),Object(S.jsx)(O.a.Control,{readOnly:!0,type:"text",isInvalid:"Mora"==r.paciente.empresa.estado,value:r.paciente.empresa.estado.toUpperCase()})]})]})]}),Object(S.jsxs)("fieldset",{children:[Object(S.jsx)("legend",{children:"Doctor"}),Object(S.jsxs)(O.a.Group,{controlId:"doctor",children:[Object(S.jsx)(O.a.Label,{children:"Nombre"}),Object(S.jsxs)(O.a.Control,{as:"select",type:"text",onChange:P,value:r.doctor.id,children:[Object(S.jsx)("option",{id:"0"}),Q.map((function(e){return Object(S.jsx)("option",{id:String(e.id),value:String(e.id),children:e.nombre},e.id)}))]})]})]}),Object(S.jsxs)("fieldset",{children:[Object(S.jsx)("legend",{children:"Servicios"}),Object(S.jsxs)(p.a,{children:[Object(S.jsx)("thead",{children:Object(S.jsxs)("tr",{children:[Object(S.jsx)("th",{style:{width:0},children:"#"}),Object(S.jsx)("th",{children:"Nombre"}),Object(S.jsx)("th",{children:"Nota"}),Object(S.jsx)("th",{style:{width:0}})]})}),Object(S.jsxs)("tbody",{children:[r.servicios.map((function(e,t){return Object(S.jsxs)("tr",{children:[Object(S.jsx)("td",{children:t+1}),Object(S.jsx)("td",{children:e.nombre}),Object(S.jsx)("td",{children:e.nota}),Object(S.jsx)("td",{children:Object(S.jsx)(u.a,{variant:"link",onClick:function(){c(Object(j.a)(Object(j.a)({},r),{},{servicios:r.servicios.filter((function(e,r){return t!=r}))}))},className:"btn-icon",children:Object(S.jsx)(C.a,{})})})]})})),Object(S.jsxs)("tr",{children:[Object(S.jsx)("td",{children:r.servicios.length+1}),Object(S.jsx)("td",{children:Object(S.jsxs)(O.a.Control,{as:"select",value:s.id,onChange:function(e){console.log("onChange required service",e.target.value),y(Object(j.a)(Object(j.a)({},s),{},{id:parseInt(e.target.value)}))},children:[Object(S.jsx)("option",{id:"0"}),re.map((function(e){return Object(S.jsx)("option",{id:String(e.id),value:String(e.id),children:e.nombre},e.id)}))]})}),Object(S.jsx)("td",{children:Object(S.jsx)(O.a.Control,{as:"textarea",value:s.nota,onChange:function(e){y(Object(j.a)(Object(j.a)({},s),{},{nota:e.target.value}))}})}),Object(S.jsx)("td",{children:Object(S.jsx)(u.a,{variant:"link",onClick:function(){console.log("Required Service",s);var e=W.find((function(e){return e.id==s.id}));e&&(c(Object(j.a)(Object(j.a)({},r),{},{servicios:[].concat(Object(i.a)(r.servicios),[{id:e.id,nombre:e.nombre,nota:s.nota}])})),y({id:0,nota:""}))},className:"btn-icon",children:Object(S.jsx)(C.b,{})})})]})]})]})]}),Object(S.jsxs)("fieldset",{children:[Object(S.jsx)("legend",{children:"Proveedor"}),Object(S.jsxs)(O.a.Group,{controlId:"doctor",children:[Object(S.jsx)(O.a.Label,{children:"Nombre"}),Object(S.jsxs)(O.a.Control,{as:"select",type:"text",onChange:T,value:r.proveedor.id,children:[Object(S.jsx)("option",{id:"0"}),Z.map((function(e){return Object(S.jsx)("option",{id:String(e.id),value:String(e.id),children:e.nombre},e.id)}))]})]})]}),Object(S.jsx)(u.a,{variant:"primary",type:"submit",children:"Guardar"})]}),Object(S.jsxs)(x.a,{show:R.data&&!R.error,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(S.jsx)(x.a.Header,{closeButton:!0,children:Object(S.jsx)(x.a.Title,{id:"contained-modal-title-vcenter",children:"D.M. - 11"})}),Object(S.jsx)(x.a.Body,{children:ce()}),Object(S.jsx)(x.a.Footer,{children:Object(S.jsx)(u.a,{children:"Close"})})]})]}):Object(S.jsx)(g.a,{animation:"border"})]})]})},T=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,64)).then((function(t){var r=t.getCLS,n=t.getFID,c=t.getFCP,a=t.getLCP,o=t.getTTFB;r(e),n(e),c(e),a(e),o(e)}))};o.a.render(Object(S.jsx)(c.a.StrictMode,{children:Object(S.jsx)(P,{})}),document.getElementById("root")),T()}},[[53,1,2]]]);
//# sourceMappingURL=main.01775995.chunk.js.map