(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{20:function(e){e.exports=JSON.parse('{"a":"https://cscra2.mybluemix.net/api"}')},48:function(e,t,r){},54:function(e,t,r){},55:function(e,t,r){"use strict";r.r(t);var n=r(0),c=r.n(n),a=r(18),i=r.n(a),o=(r(48),r(64)),s=r(63),d=r(62),l=r(57),j=r(60),b=r(43),u=r(7),O=r(9),h=r(58),p=r(59),f=r(61),x=r(37),m=r(41),v=r(1),g=function(e){var t=Object(n.useState)(0),r=Object(O.a)(t,2),c=r[0],a=r[1],i=e.placeholder,o=e.loading;Object(n.useEffect)((function(){var e=setInterval((function(){a((function(e){return(e+1)%3}))}),1e3);return function(){return clearInterval(e)}}),[]);var s=i+(o?new Array(c+1).join("."):"");return Object(v.jsx)("input",Object(u.a)(Object(u.a)({},e),{},{placeholder:s}))},y=r(39),C=r.n(y);function S(e){var t=e.url,r=e.height;return Object(n.useEffect)((function(){C.a.embed(t,"#pdfcontainer",{fallbackLink:'<p>Este navegador no soporta la visualizacion de archivos PDF en linea, por favor descarga el archivo haciendo clic : <a href="[url]">aqu\xed</a></p>'})}),[t]),Object(v.jsx)("div",{id:"pdfcontainer",style:{height:r}})}var k=r(36),I=r.n(k),E=r(40),N=function(e,t){var r=Object(n.useState)({}),c=Object(O.a)(r,2),a=c[0],i=c[1],o=function(e,t){var r=Object(n.useRef)(e);return Object(n.useEffect)((function(){r.current=e}),[t]),r}(e,t);return[a,Object(n.useCallback)((function(){(function(){var e=Object(E.a)(I.a.mark((function e(){var t,r;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i({completed:!1}),e.next=3,o.current();case 3:return t=e.sent,e.next=6,Array.isArray(t)?Promise.all(t.map((function(e){return e.json()}))):t.json();case 6:r=e.sent,Array.isArray(t)?t.every((function(e){return e.ok})):t.ok,i({completed:!0,data:r,error:!1});case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()().catch((function(e){i({completed:!0,error:!0})}))}),[])]},L=r(20),w={id:0,carnet:"",nombre:"",empresa:{nombre:"",estado:""}},B=function(e){var t=e.paciente,r=e.onChange,c=Object(n.useRef)(t.carnet),a=N((function(){return fetch(L.a+"/pacientes?carnet=".concat(t.carnet))}),[t.carnet]),i=Object(O.a)(a,2),o=i[0],s=i[1],l=Object(n.useCallback)((function(e){var t=e.target.value.toUpperCase();r(Object(u.a)(Object(u.a)({},w),{},{carnet:t}))}),[t]),j=Object(n.useCallback)((function(e){c.current!=t.carnet&&(c.current=t.carnet,s())}),[t.carnet]);return Object(n.useEffect)((function(){if(o.completed&&!o.error){var e=o.data;e.length&&r(e[0])}}),[o]),Object(v.jsxs)("fieldset",{title:"Paciente",children:[Object(v.jsx)("legend",{children:"Paciente"}),Object(v.jsxs)(d.a.Row,{children:[Object(v.jsxs)(d.a.Group,{as:m.a,sm:!0,controlId:"carnet_paciente",children:[Object(v.jsx)(d.a.Label,{children:"N\xba Carnet"}),Object(v.jsx)(d.a.Control,{type:"text",isInvalid:o.completed&&!o.error&&!o.data.length,onChange:l,onBlur:j,value:t.carnet})]}),Object(v.jsxs)(d.a.Group,{as:m.a,sm:9,controlId:"nombre_paciente",children:[Object(v.jsx)(d.a.Label,{children:"Nombre"}),Object(v.jsx)(d.a.Control,{as:g,loading:!1===o.completed,placeholder:!1===o.completed?"Buscando":o.error?"Error":"",readOnly:!0,type:"text",value:t.nombre.toUpperCase()})]})]}),Object(v.jsxs)(d.a.Row,{children:[Object(v.jsxs)(d.a.Group,{as:m.a,sm:9,controlId:"empresa",children:[Object(v.jsx)(d.a.Label,{children:"Empresa"}),Object(v.jsx)(d.a.Control,{as:g,loading:!1===o.completed,placeholder:!1===o.completed?"Buscando":o.error?"Error":"",readOnly:!0,type:"text",value:t.empresa.nombre.toUpperCase()})]}),Object(v.jsxs)(d.a.Group,{as:m.a,sm:!0,controlId:"estado",children:[Object(v.jsx)(d.a.Label,{children:"Estado"}),Object(v.jsx)(d.a.Control,{as:g,loading:!1===o.completed,placeholder:!1===o.completed?"Buscando":o.error?"Error":"",readOnly:!0,type:"text",isInvalid:"Mora"==t.empresa.estado,value:t.empresa.estado.toUpperCase()})]})]})]})};var F=function(){var e=Object(n.useState)({paciente:{id:0,carnet:"",nombre:"",empresa:{nombre:"",estado:""}},doctor:{id:0,nombre:""},proveedor:{id:0,nombre:"",servicios:[]},servicios:[]}),t=Object(O.a)(e,2),r=t[0],c=t[1],a=Object(n.useState)({id:0,nota:""}),i=Object(O.a)(a,2),o=i[0],s=i[1],j=Object(n.useCallback)((function(e){c(Object(u.a)(Object(u.a)({},r),{},{doctor:_.find((function(t){return t.id==parseInt(e.target.value)}))||{id:0,nombre:""}}))}),[r]),m=Object(n.useCallback)((function(e){c(Object(u.a)(Object(u.a)({},r),{},{proveedor:A.find((function(t){return t.id==parseInt(e.target.value)}))||{id:0,nombre:"",servicios:[]}}))}),[r]),g=Object(n.useRef)(Math.random());console.log("Random",g);var y=N((function(){return fetch(L.a+"/transferencias",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paciente_id:r.paciente.id,doctor_id:r.doctor.id,proveedor_id:r.proveedor.id,servicios_ids:r.servicios.map((function(e){return e.id}))})})}),[r]),C=Object(O.a)(y,2),k=C[0],I=C[1],E=Object(n.useCallback)((function(e){e.preventDefault(),I()}),[]),w=N((function(){return Promise.all([fetch(L.a+"/doctores"),fetch(L.a+"/proveedores"),fetch(L.a+"/servicios")])}),[]),F=Object(O.a)(w,2),P=F[0],T=F[1],G=P.data||[[],[],[]],R=Object(O.a)(G,3),_=R[0],A=R[1],D=R[2],z=Object(n.useState)(A),J=Object(O.a)(z,2),M=J[0],U=J[1],q=Object(n.useState)(D),H=Object(O.a)(q,2),K=H[0],Q=H[1];Object(n.useEffect)((function(){return T()}),[]),Object(n.useEffect)((function(){if(P.completed&&!P.error){var e=A.filter((function(e){return r.servicios.every((function(t){return e.servicios.some((function(e){return e.id==t.id}))}))}));U(e),e.some((function(e){return e.id==r.proveedor.id}))||c(Object(u.a)(Object(u.a)({},r),{},{proveedor:{id:0,nombre:"",servicios:[]}})),1==e.length&&c(Object(u.a)(Object(u.a)({},r),{},{proveedor:e[0]}));var t=D.filter((function(t){return e.some((function(e){return!r.servicios.some((function(e){return e.id==t.id}))&&e.servicios.some((function(e){return e.id==t.id}))}))}));Q(t)}}),[r.servicios,P]);var V=function(){var e=k.data&&k.data.url;return e?Object(v.jsx)(S,{url:e,height:400}):null};return console.log("FormState",r),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("h1",{children:"Transferencia externa"}),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)(d.a,{style:{marginTop:20,marginBottom:20},onSubmit:E,children:[Object(v.jsx)(B,{paciente:r.paciente,onChange:function(e){c(Object(u.a)(Object(u.a)({},r),{},{paciente:e}))}}),Object(v.jsxs)("fieldset",{children:[Object(v.jsx)("legend",{children:"Doctor"}),Object(v.jsxs)(d.a.Group,{controlId:"doctor",children:[Object(v.jsx)(d.a.Label,{children:"Nombre"}),Object(v.jsxs)(d.a.Control,{as:"select",type:"text",onChange:j,value:r.doctor.id,children:[Object(v.jsx)("option",{id:"0"}),_.map((function(e){return Object(v.jsx)("option",{id:String(e.id),value:String(e.id),children:e.nombre},e.id)}))]})]})]}),Object(v.jsxs)("fieldset",{children:[Object(v.jsx)("legend",{children:"Servicios"}),Object(v.jsxs)(h.a,{children:[Object(v.jsx)("thead",{children:Object(v.jsxs)("tr",{children:[Object(v.jsx)("th",{style:{width:0},children:"#"}),Object(v.jsx)("th",{children:"Nombre"}),Object(v.jsx)("th",{children:"Nota"}),Object(v.jsx)("th",{style:{width:0}})]})}),Object(v.jsxs)("tbody",{children:[r.servicios.map((function(e,t){return Object(v.jsxs)("tr",{children:[Object(v.jsx)("td",{children:t+1}),Object(v.jsx)("td",{children:e.nombre}),Object(v.jsx)("td",{children:e.nota}),Object(v.jsx)("td",{children:Object(v.jsx)(l.a,{variant:"link",onClick:function(){c(Object(u.a)(Object(u.a)({},r),{},{servicios:r.servicios.filter((function(e,r){return t!=r}))}))},className:"btn-icon",children:Object(v.jsx)(x.a,{})})})]})})),Object(v.jsxs)("tr",{children:[Object(v.jsx)("td",{children:r.servicios.length+1}),Object(v.jsx)("td",{children:Object(v.jsxs)(d.a.Control,{as:"select",value:o.id,onChange:function(e){console.log("onChange required service",e.target.value),s(Object(u.a)(Object(u.a)({},o),{},{id:parseInt(e.target.value)}))},children:[Object(v.jsx)("option",{id:"0"}),K.map((function(e){return Object(v.jsx)("option",{id:String(e.id),value:String(e.id),children:e.nombre},e.id)}))]})}),Object(v.jsx)("td",{children:Object(v.jsx)(d.a.Control,{as:"textarea",value:o.nota,onChange:function(e){s(Object(u.a)(Object(u.a)({},o),{},{nota:e.target.value}))}})}),Object(v.jsx)("td",{children:Object(v.jsx)(l.a,{variant:"link",onClick:function(){console.log("Required Service",o);var e=D.find((function(e){return e.id==o.id}));e&&(c(Object(u.a)(Object(u.a)({},r),{},{servicios:[].concat(Object(b.a)(r.servicios),[{id:e.id,nombre:e.nombre,nota:o.nota}])})),s({id:0,nota:""}))},className:"btn-icon",children:Object(v.jsx)(x.b,{})})})]})]})]})]}),Object(v.jsxs)("fieldset",{children:[Object(v.jsx)("legend",{children:"Proveedor"}),Object(v.jsxs)(d.a.Group,{controlId:"doctor",children:[Object(v.jsx)(d.a.Label,{children:"Nombre"}),Object(v.jsxs)(d.a.Control,{as:"select",type:"text",onChange:m,value:r.proveedor.id,children:[Object(v.jsx)("option",{id:"0"}),M.map((function(e){return Object(v.jsx)("option",{id:String(e.id),value:String(e.id),children:e.nombre},e.id)}))]})]})]}),Object(v.jsxs)(l.a,{variant:"primary",type:"submit",children:[!1===k.completed&&Object(v.jsx)(p.a,{animation:"border",size:"sm"})," Guardar"]})]}),Object(v.jsxs)(f.a,{show:k.data&&!k.error,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(v.jsx)(f.a.Header,{closeButton:!0,children:Object(v.jsx)(f.a.Title,{id:"contained-modal-title-vcenter",children:"D.M. - 11"})}),Object(v.jsx)(f.a.Body,{children:V()}),Object(v.jsx)(f.a.Footer,{children:Object(v.jsx)(l.a,{children:"Close"})})]})]}),Object(v.jsxs)(f.a,{show:!P.completed,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(v.jsx)(f.a.Header,{children:Object(v.jsx)(f.a.Title,{id:"contained-modal-title-vcenter",children:"Cargando"})}),Object(v.jsx)(f.a.Body,{children:Object(v.jsx)(p.a,{animation:"border"})})]})]})},P=(r(54),function(){return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)(o.a,{bg:"dark",variant:"dark",children:[Object(v.jsx)(o.a.Brand,{href:"#home",children:"Navbar"}),Object(v.jsxs)(s.a,{className:"mr-auto",children:[Object(v.jsx)(s.a.Link,{href:"#home",children:"Home"}),Object(v.jsx)(s.a.Link,{href:"#features",children:"Features"}),Object(v.jsx)(s.a.Link,{href:"#pricing",children:"Pricing"})]}),Object(v.jsxs)(d.a,{inline:!0,children:[Object(v.jsx)(d.a.Control,{type:"text",placeholder:"Search",className:"mr-sm-2"}),Object(v.jsx)(l.a,{variant:"outline-info",children:"Search"})]})]}),Object(v.jsx)(j.a,{style:{marginTop:20},children:Object(v.jsx)(F,{})})]})}),T=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,65)).then((function(t){var r=t.getCLS,n=t.getFID,c=t.getFCP,a=t.getLCP,i=t.getTTFB;r(e),n(e),c(e),a(e),i(e)}))};i.a.render(Object(v.jsx)(c.a.StrictMode,{children:Object(v.jsx)(P,{})}),document.getElementById("root")),T()}},[[55,1,2]]]);
//# sourceMappingURL=main.d55b7892.chunk.js.map